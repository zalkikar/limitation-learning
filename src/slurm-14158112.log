/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/tensor.py:447: UserWarning: non-inplace resize is deprecated
  warnings.warn("non-inplace resize is deprecated")
0:: 2048 episode score is 0.69
0:: 2048 episode similarity score is 0.00
Traceback (most recent call last):
  File "main.py", line 229, in <module>
    main()
  File "main.py", line 192, in main
    expert_acc, learner_acc = train_discrim(discrim, memory, discrim_optim, args) 
  File "/scratch/nsk367/deepRL/limitation-learning/src/GAIL.py", line 125, in train_discrim
    learner = discrim(states, actions) #pass (s,a) through discriminator
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/nsk367/deepRL/limitation-learning/src/models/discriminator.py", line 51, in forward
    state = self.state_encoder(state) # idk how good these are 
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/nsk367/deepRL/limitation-learning/src/models/encoders.py", line 42, in forward
    out, _ = self.memory_cell(x)
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/nsk367/anaconda3/envs/irl/lib/python3.8/site-packages/torch/nn/modules/rnn.py", line 581, in forward
    result = _VF.lstm(input, hx, self._flat_weights, self.bias, self.num_layers,
RuntimeError: CUDA out of memory. Tried to allocate 14.98 GiB (GPU 0; 15.78 GiB total capacity; 6.63 GiB already allocated; 7.84 GiB free; 6.72 GiB reserved in total by PyTorch)
